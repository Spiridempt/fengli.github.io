{"sha":"b4842bd387626000288c179287a531a57a35117c","commit":{"author":{"name":"Magnus Ernstsson","email":"magnus@ernstsson.net","date":"2016-05-29T12:10:51Z"},"committer":{"name":"Magnus Ernstsson","email":"magnus@ernstsson.net","date":"2016-05-29T12:10:51Z"},"message":"Changed BaseObservable to throw NPE if adding/removing null updatable (#60)\n\nFixes #51","tree":{"sha":"10b28a07ca72336c5aa8784402cc91012ac04ab0","url":"https://api.github.com/repos/google/agera/git/trees/10b28a07ca72336c5aa8784402cc91012ac04ab0"},"url":"https://api.github.com/repos/google/agera/git/commits/b4842bd387626000288c179287a531a57a35117c","comment_count":0},"url":"https://api.github.com/repos/google/agera/commits/b4842bd387626000288c179287a531a57a35117c","html_url":"https://github.com/google/agera/commit/b4842bd387626000288c179287a531a57a35117c","comments_url":"https://api.github.com/repos/google/agera/commits/b4842bd387626000288c179287a531a57a35117c/comments","author":{"login":"ernstsson","id":378389,"avatar_url":"https://avatars2.githubusercontent.com/u/378389?v=3","gravatar_id":"","url":"https://api.github.com/users/ernstsson","html_url":"https://github.com/ernstsson","followers_url":"https://api.github.com/users/ernstsson/followers","following_url":"https://api.github.com/users/ernstsson/following{/other_user}","gists_url":"https://api.github.com/users/ernstsson/gists{/gist_id}","starred_url":"https://api.github.com/users/ernstsson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernstsson/subscriptions","organizations_url":"https://api.github.com/users/ernstsson/orgs","repos_url":"https://api.github.com/users/ernstsson/repos","events_url":"https://api.github.com/users/ernstsson/events{/privacy}","received_events_url":"https://api.github.com/users/ernstsson/received_events","type":"User","site_admin":false},"committer":{"login":"ernstsson","id":378389,"avatar_url":"https://avatars2.githubusercontent.com/u/378389?v=3","gravatar_id":"","url":"https://api.github.com/users/ernstsson","html_url":"https://github.com/ernstsson","followers_url":"https://api.github.com/users/ernstsson/followers","following_url":"https://api.github.com/users/ernstsson/following{/other_user}","gists_url":"https://api.github.com/users/ernstsson/gists{/gist_id}","starred_url":"https://api.github.com/users/ernstsson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernstsson/subscriptions","organizations_url":"https://api.github.com/users/ernstsson/orgs","repos_url":"https://api.github.com/users/ernstsson/repos","events_url":"https://api.github.com/users/ernstsson/events{/privacy}","received_events_url":"https://api.github.com/users/ernstsson/received_events","type":"User","site_admin":false},"parents":[{"sha":"5f7a7f3822553446f54bfd22f95feaab19a64cf0","url":"https://api.github.com/repos/google/agera/commits/5f7a7f3822553446f54bfd22f95feaab19a64cf0","html_url":"https://github.com/google/agera/commit/5f7a7f3822553446f54bfd22f95feaab19a64cf0"}],"stats":{"total":12,"additions":12,"deletions":0},"files":[{"sha":"3511fa53efc66480520455e9ed21ddaf8ca8fcae","filename":"agera/src/main/java/com/google/android/agera/BaseObservable.java","status":"modified","additions":3,"deletions":0,"changes":3,"blob_url":"https://github.com/google/agera/blob/b4842bd387626000288c179287a531a57a35117c/agera/src/main/java/com/google/android/agera/BaseObservable.java","raw_url":"https://github.com/google/agera/raw/b4842bd387626000288c179287a531a57a35117c/agera/src/main/java/com/google/android/agera/BaseObservable.java","contents_url":"https://api.github.com/repos/google/agera/contents/agera/src/main/java/com/google/android/agera/BaseObservable.java?ref=b4842bd387626000288c179287a531a57a35117c","patch":"@@ -16,6 +16,7 @@\n package com.google.android.agera;\n \n import static android.os.SystemClock.elapsedRealtime;\n+import static com.google.android.agera.Preconditions.checkNotNull;\n import static com.google.android.agera.Preconditions.checkState;\n import static com.google.android.agera.WorkerHandler.MSG_LAST_REMOVED;\n import static com.google.android.agera.WorkerHandler.MSG_UPDATE;\n@@ -64,6 +65,7 @@ protected BaseObservable() {\n   @Override\n   public synchronized final void addUpdatable(@NonNull final Updatable updatable) {\n     checkState(Looper.myLooper() != null, \"Can only be added on a Looper thread\");\n+    checkNotNull(updatable);\n     add(updatable, workerHandler());\n     if (size == 1) {\n       if (handler.hasMessages(MSG_LAST_REMOVED, this)) {\n@@ -77,6 +79,7 @@ public synchronized final void addUpdatable(@NonNull final Updatable updatable)\n   @Override\n   public synchronized final void removeUpdatable(@NonNull final Updatable updatable) {\n     checkState(Looper.myLooper() != null, \"Can only be removed on a Looper thread\");\n+    checkNotNull(updatable);\n     remove(updatable);\n     if (size == 0) {\n       handler.obtainMessage(MSG_LAST_REMOVED, this).sendToTarget();"},{"sha":"afb7a4b96ba049dcbca63cc1f49f535ecc196d1a","filename":"agera/src/test/java/com/google/android/agera/ObservablesTest.java","status":"modified","additions":9,"deletions":0,"changes":9,"blob_url":"https://github.com/google/agera/blob/b4842bd387626000288c179287a531a57a35117c/agera/src/test/java/com/google/android/agera/ObservablesTest.java","raw_url":"https://github.com/google/agera/raw/b4842bd387626000288c179287a531a57a35117c/agera/src/test/java/com/google/android/agera/ObservablesTest.java","contents_url":"https://api.github.com/repos/google/agera/contents/agera/src/test/java/com/google/android/agera/ObservablesTest.java?ref=b4842bd387626000288c179287a531a57a35117c","patch":"@@ -251,6 +251,15 @@ public void shouldNotRefreshObservableIfReactivatedWithinSameCycle() {\n     verify(supplier).get();\n   }\n \n+  @Test(expected = NullPointerException.class)\n+  public void shouldThrowNullPointerExceptionForAddNullUpdatable() {\n+    updateDispatcher.addUpdatable(null);\n+  }\n+\n+  @Test(expected = NullPointerException.class)\n+  public void shouldThrowNullPointerExceptionForRemoveNullUpdatable() {\n+    updateDispatcher.removeUpdatable(null);\n+  }\n \n   @Test\n   public void shouldOnlyUpdateOncePerLooper() {"}]}