{"sha":"34c6c31de0887d471a8077896a9608a7555bace6","commit":{"author":{"name":"Magnus Ernstsson","email":"magnus@ernstsson.net","date":"2016-05-14T20:53:52Z"},"committer":{"name":"Magnus Ernstsson","email":"magnus@ernstsson.net","date":"2016-05-14T21:02:42Z"},"message":"Added some additional unit tests","tree":{"sha":"d7aa6a6d9f03390cefecb0f13870dabc48c95736","url":"https://api.github.com/repos/google/agera/git/trees/d7aa6a6d9f03390cefecb0f13870dabc48c95736"},"url":"https://api.github.com/repos/google/agera/git/commits/34c6c31de0887d471a8077896a9608a7555bace6","comment_count":0},"url":"https://api.github.com/repos/google/agera/commits/34c6c31de0887d471a8077896a9608a7555bace6","html_url":"https://github.com/google/agera/commit/34c6c31de0887d471a8077896a9608a7555bace6","comments_url":"https://api.github.com/repos/google/agera/commits/34c6c31de0887d471a8077896a9608a7555bace6/comments","author":{"login":"ernstsson","id":378389,"avatar_url":"https://avatars2.githubusercontent.com/u/378389?v=3","gravatar_id":"","url":"https://api.github.com/users/ernstsson","html_url":"https://github.com/ernstsson","followers_url":"https://api.github.com/users/ernstsson/followers","following_url":"https://api.github.com/users/ernstsson/following{/other_user}","gists_url":"https://api.github.com/users/ernstsson/gists{/gist_id}","starred_url":"https://api.github.com/users/ernstsson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernstsson/subscriptions","organizations_url":"https://api.github.com/users/ernstsson/orgs","repos_url":"https://api.github.com/users/ernstsson/repos","events_url":"https://api.github.com/users/ernstsson/events{/privacy}","received_events_url":"https://api.github.com/users/ernstsson/received_events","type":"User","site_admin":false},"committer":{"login":"ernstsson","id":378389,"avatar_url":"https://avatars2.githubusercontent.com/u/378389?v=3","gravatar_id":"","url":"https://api.github.com/users/ernstsson","html_url":"https://github.com/ernstsson","followers_url":"https://api.github.com/users/ernstsson/followers","following_url":"https://api.github.com/users/ernstsson/following{/other_user}","gists_url":"https://api.github.com/users/ernstsson/gists{/gist_id}","starred_url":"https://api.github.com/users/ernstsson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernstsson/subscriptions","organizations_url":"https://api.github.com/users/ernstsson/orgs","repos_url":"https://api.github.com/users/ernstsson/repos","events_url":"https://api.github.com/users/ernstsson/events{/privacy}","received_events_url":"https://api.github.com/users/ernstsson/received_events","type":"User","site_admin":false},"parents":[{"sha":"bbf914627a36ff5b61828ae8842adf4d3309c109","url":"https://api.github.com/repos/google/agera/commits/bbf914627a36ff5b61828ae8842adf4d3309c109","html_url":"https://github.com/google/agera/commit/bbf914627a36ff5b61828ae8842adf4d3309c109"}],"stats":{"total":39,"additions":39,"deletions":0},"files":[{"sha":"f7c6fb08850d63047177d8d0a9b5f5f6a58862ab","filename":"agera/src/test/java/com/google/android/agera/ObservablesTest.java","status":"modified","additions":8,"deletions":0,"changes":8,"blob_url":"https://github.com/google/agera/blob/34c6c31de0887d471a8077896a9608a7555bace6/agera/src/test/java/com/google/android/agera/ObservablesTest.java","raw_url":"https://github.com/google/agera/raw/34c6c31de0887d471a8077896a9608a7555bace6/agera/src/test/java/com/google/android/agera/ObservablesTest.java","contents_url":"https://api.github.com/repos/google/agera/contents/agera/src/test/java/com/google/android/agera/ObservablesTest.java?ref=34c6c31de0887d471a8077896a9608a7555bace6","patch":"@@ -24,6 +24,7 @@\n import static com.google.android.agera.Observables.perMillisecondObservable;\n import static com.google.android.agera.Observables.updateDispatcher;\n import static com.google.android.agera.Repositories.repositoryWithInitialValue;\n+import static com.google.android.agera.WorkerHandler.workerHandler;\n import static com.google.android.agera.test.matchers.HasPrivateConstructor.hasPrivateConstructor;\n import static com.google.android.agera.test.matchers.UpdatableUpdated.wasUpdated;\n import static com.google.android.agera.test.mocks.MockUpdatable.mockUpdatable;\n@@ -313,6 +314,13 @@ public void shouldHandleManyObservables() {\n   }\n \n   @Test\n+  public void shouldCallMessageObjUpdateForMsgCallUpdatableMessage() {\n+    workerHandler().obtainMessage(WorkerHandler.MSG_CALL_UPDATABLE, updatable).sendToTarget();\n+\n+    assertThat(updatable, wasUpdated());\n+  }\n+\n+  @Test\n   public void shouldHavePrivateConstructor() {\n     assertThat(Observables.class, hasPrivateConstructor());\n   }"},{"sha":"5cdd8cdf2ec9b0e4b5fefec568f3a4363aae1d0d","filename":"extensions/rvadapter/src/test/java/com/google/android/agera/rvadapter/RepositoryAdapterTest.java","status":"modified","additions":31,"deletions":0,"changes":31,"blob_url":"https://github.com/google/agera/blob/34c6c31de0887d471a8077896a9608a7555bace6/extensions/rvadapter/src/test/java/com/google/android/agera/rvadapter/RepositoryAdapterTest.java","raw_url":"https://github.com/google/agera/raw/34c6c31de0887d471a8077896a9608a7555bace6/extensions/rvadapter/src/test/java/com/google/android/agera/rvadapter/RepositoryAdapterTest.java","contents_url":"https://api.github.com/repos/google/agera/contents/extensions/rvadapter/src/test/java/com/google/android/agera/rvadapter/RepositoryAdapterTest.java?ref=34c6c31de0887d471a8077896a9608a7555bace6","patch":"@@ -25,6 +25,7 @@\n import static org.mockito.Matchers.any;\n import static org.mockito.Matchers.anyInt;\n import static org.mockito.Mockito.never;\n+import static org.mockito.Mockito.times;\n import static org.mockito.Mockito.verify;\n import static org.mockito.Mockito.when;\n import static org.mockito.MockitoAnnotations.initMocks;\n@@ -36,7 +37,9 @@\n import com.google.android.agera.UpdateDispatcher;\n \n import android.content.Context;\n+import android.support.annotation.LayoutRes;\n import android.support.v7.widget.RecyclerView;\n+import android.support.v7.widget.RecyclerView.AdapterDataObserver;\n import android.view.LayoutInflater;\n import android.view.View;\n import android.view.ViewGroup;\n@@ -55,6 +58,7 @@\n   private static final List<String> REPOSITORY_LIST = asList(\"a\", \"b\", \"c\");\n   private static final String REPOSITORY_ITEM = \"d\";\n   private static final String ALTERNATIVE_REPOSITORY_ITEM = \"e\";\n+  @LayoutRes\n   public static final int LAYOUT_ID = 3;\n   @Mock\n   private RepositoryPresenter repositoryPresenter;\n@@ -70,6 +74,8 @@\n   private LayoutInflater layoutInflater;\n   @Mock\n   private View view;\n+  @Mock\n+  private AdapterDataObserver observer;\n   private UpdateDispatcher updateDispatcher;\n   private MutableRepository repository;\n   private Repository secondRepository;\n@@ -121,6 +127,19 @@ public void shouldThrowExceptionForOutOfBoundsIndex() {\n     repositoryAdapter.getItemId(4);\n   }\n \n+\n+  @Test(expected = IndexOutOfBoundsException.class)\n+  public void shouldThrowExceptionForNegativeIndex() {\n+    repositoryAdapter.getItemId(-1);\n+  }\n+\n+  @Test(expected = IllegalArgumentException.class)\n+  public void shouldThrowExceptionForAdapterWithoutRepositories() {\n+    repositoryAdapter()\n+        .addAdditionalObservable(updateDispatcher)\n+        .build();\n+  }\n+\n   @Test\n   public void shouldReturnItemViewTypeFromFirstPresenter() {\n     when(repositoryPresenter.getLayoutResId(REPOSITORY_ITEM, 0)).thenReturn(1);\n@@ -143,6 +162,18 @@ public void shouldCreateViewHolder() {\n   }\n \n   @Test\n+  public void shouldUpdateOnAdditionalObservablesWhenObserving() {\n+    repositoryAdapter.registerAdapterDataObserver(observer);\n+\n+    repositoryAdapter.startObserving();\n+    updateDispatcher.update();\n+    runUiThreadTasksIncludingDelayedTasks();\n+    repositoryAdapter.stopObserving();\n+\n+    verify(observer, times(2)).onChanged();\n+  }\n+\n+  @Test\n   public void shouldUpdateOnChangingRepositoryWhenObserving() {\n     when(repositoryPresenter.getItemCount(ALTERNATIVE_REPOSITORY_ITEM)).thenReturn(1);\n     repositoryAdapter.getItemCount(); //Trigger a refresh"}]}